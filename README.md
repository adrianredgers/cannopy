Cannopy - ANN in C++ with pybind11 interface to Python
-
- **Python**
- **Project targets**
- **Project files**
- **in-source** vs **out-of-source**:
- **CLion tips**
- **CMake**
- **Contact**


**Overview**
`cannopy` is a C++ `pybind1l` shared library to be imported as a module into Python.
 This project builds the Python module `cannopy.so` and shared library `libCannopyLib.so`, and copies them into 
`$PYTHON_DIST_DIR` so `cannopy` is available as a module to be imported into Python.

For more information / explanation on how to create a C++ python module with `pybind11` see:
`https://github.com/adrianredgers/cmake-googletest-pybind11-example`

```
$ ./compile.sh
$ ./build/runUnitTests
$ echo $?
0
$ python
Python 2.7.12 (default, Dec  4 2017, 14:50:18) 
[GCC 5.4.0 20160609] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import cannopy
>>> r = cannopy.RAM(3)
>>> addr=[1,1,0]
>>> r.lookup(addr)
0
>>> r.set(addr,1)
>>> r.lookup(addr)
1
>>> r.reset()
>>> r.lookup(addr)
0
>>> exit()
``` 

**Project targets**
- `cannopy` - creates Python (shared library) module `cannopy.so`. Copied to $PYTHON_DIST_DIR.
    - Requires `libCannopyLib.so`.
- `CannopylLib` - creates shared library `libCannopyLib.so`, used by `cannopy.so`, unit tests and available for any other C++.
- `*UnitTests` - executables for running unit tests outside of CLion, these use `libCannopyLib.so`. 


**Project files**
- `CMakeLists.txt` - top-level CMake file that calls the `main` and `test` CMake files.
- `compile.sh` 
    - attempts to add `$PYTHON_DIST_DIR` to `$LD_LIBRARY_PATH`
    - deletes and recreates `build` directory, 
    - runs `cmake` and then `make`.
- `src\include`
    - Public interfaces for `libCannopyLib.so`, used by `PyModule.cpp` and by tests.
- `src/main`
    - `CMakeLists.txt` - CMake for the main targets: `CannopyLib` and `cannopy`, copies `cannopy.so` and `libCannopyLib.so` to $PYTHON_DIST_DIR.
    - `Adrian_p.h` - private general include definitions.
    - `PyModule.cpp` - defines interface to our C++ library in the Python module `cannopy.so`.
    - `lib/pybind11` - pybind11 source cloned from: `git@github.com:pybind/pybind11.git`.
    - <any other source directories> 
- `src/test`
    - `CMakeLists.txt` - top-level CMake for test target: `*UnitTests`.
    - `lib/googletest` - googletest source code.
        - Cloned from: `git@github.com:google/googletest.git`.
- `build` - temporary directory containing targets and artifacts.
    - Auto-generated, not under source code control
    - Regenerated by running `compile.sh`.
- `cmake-build-debug` - another temporary directory.
    - Annoyingly generated by CLion until you set out-of-source dir to `build` (see **CLion tips** below).


**Contact me**
- This is my second attempt at a lot of things - CMake, CLion, googletest, python, pybind11, C++, GitHub, README ml etc.
- I would be grateful for any (non-painful) suggestions:-
    - aredgers@yahoo.com
        

